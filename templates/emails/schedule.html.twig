<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" /> <!-- disable auto telephone linking in iOS -->
    <title>
        Semaine {{ weeksheet.beginAt | format_date(pattern="w") }}
        - {{ weeksheet.user.lastname | capitalize }} {{ weeksheet.user.firstname | first }}.    
    </title>
    <style type="text/css">
        /*! CSS Used from: https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css */
        *,::after,::before{box-sizing:border-box;}
        body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff;}
        [tabindex="-1"]:focus:not(:focus-visible){outline:0!important;}
        h1{margin-top:0;margin-bottom:.5rem;}
        p{margin-top:0;margin-bottom:1rem;}
        abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;border-bottom:0;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none;}
        b,strong{font-weight:bolder;}
        small{font-size:80%;}
        a{color:#007bff;text-decoration:none;background-color:transparent;}
        a:hover{color:#0056b3;text-decoration:underline;}
        img{vertical-align:middle;border-style:none;}
        svg{overflow:hidden;vertical-align:middle;}
        table{border-collapse:collapse;}
        th{text-align:inherit;}
        button{border-radius:0;}
        button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color;}
        button,input{margin:0;font-family:inherit;font-size:inherit;line-height:inherit;}
        button,input{overflow:visible;}
        button{text-transform:none;}
        [type=submit],button{-webkit-appearance:button;}
        [type=submit]::-moz-focus-inner,button::-moz-focus-inner{padding:0;border-style:none;}
        .h2,.h3,h1{margin-bottom:.5rem;font-weight:500;line-height:1.2;}
        h1{font-size:2.5rem;}
        .h2{font-size:2rem;}
        .h3{font-size:1.75rem;}
        .h4{font-size:1.50rem;}
        .lead{font-size:1.25rem;font-weight:300;}
        small{font-size:80%;font-weight:400;}
        .container-fluid{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto;}
        .row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px;}
        .col-1,.col-10,.col-11,.col-2,.col-3{position:relative;width:100%;padding-right:15px;padding-left:15px;}
        .col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%;}
        .col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%;}
        .col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%;}
        .col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%;}
        .col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%;}
        .offset-4{margin-left:33.333333%;}
        .form-group{margin-bottom:1rem;}
        .btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;}
        @media (prefers-reduced-motion:reduce){
            .btn{transition:none;}
        }
        .btn:hover{color:#212529;text-decoration:none;}
        .btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25);}
        .btn:disabled{opacity:.65;}
        .btn-success{color:#fff;background-color:#28a745;border-color:#28a745;}
        .btn-success:hover{color:#fff;background-color:#218838;border-color:#1e7e34;}
        .btn-success:focus{color:#fff;background-color:#218838;border-color:#1e7e34;box-shadow:0 0 0 .2rem rgba(72,180,97,.5);}
        .btn-success:disabled{color:#fff;background-color:#28a745;border-color:#28a745;}
        .bg-light{background-color:#f8f9fa!important;}
        .bg-white{background-color:#fff!important;}
        .bg-transparent{background-color:transparent!important;}
        .border{border:1px solid #dee2e6!important;}
        .border-left{border-left:1px solid #dee2e6!important;}
        .border-top-0{border-top:0!important;}
        .border-dark{border-color:#343a40!important;}
        .d-flex{display:-ms-flexbox!important;display:flex!important;}
        .flex-fill{-ms-flex:1 1 auto!important;flex:1 1 auto!important;}
        .justify-content-end{-ms-flex-pack:end!important;justify-content:flex-end!important;}
        .justify-content-center{-ms-flex-pack:center!important;justify-content:center!important;}
        .align-items-center{-ms-flex-align:center!important;align-items:center!important;}
        .float-left{float:left!important;}
        .overflow-hidden{overflow:hidden!important;}
        .position-relative{position:relative!important;}
        .position-absolute{position:absolute!important;}
        .m-0{margin:0!important;}
        .mb-0{margin-bottom:0!important;}
        .mr-1{margin-right:.25rem!important;}
        .ml-1{margin-left:.25rem!important;}
        .m-2{margin:.5rem!important;}
        .mr-2{margin-right:.5rem!important;}
        .mt-3{margin-top:1rem!important;}
        .m-4{margin:1.5rem!important;}
        .p-0{padding:0!important;}
        .p-2{padding:.5rem!important;}
        .pt-3{padding-top:1rem!important;}
        .pb-3{padding-bottom:1rem!important;}
        .p-4{padding:1.5rem!important;}
        .text-center{text-align:center!important;}
        .text-white{color:#fff!important;}
        .text-danger{color:#dc3545!important;}
        @media print{
            *,::after,::before{text-shadow:none!important;box-shadow:none!important;}
            a:not(.btn){text-decoration:underline;}
            abbr[title]::after{content:" (" attr(title) ")";}
            thead{display:table-header-group;}
            img,tr{page-break-inside:avoid;}
            p{orphans:3;widows:3;}
            body{min-width:992px!important;}
        }
        /*! CSS Used from: http://idee-services.localhost/assets/css/weeksheet.css */
        #main-container{width:29.7cm;height:21cm;padding: 0.5cm 1cm;}
        #logo{height:75px;}
        #header{background-color:#d0cece!important;height:50px;}
        .grid{z-index:2;}
        .grid div{height:12px;}
        svg{bottom:0;z-index:1;}
        .task-elmt{top:17px;z-index:1;}
        .task-elmt p{max-height:40px;line-height:20px;min-width:100px;overflow:hidden;}
    </style>
</head>
<body class="bg-light">
    <div id="main-container" class="border bg-white">
        <div class="container-fluid">
            <div class="row">
                <div class="col-3">
                    <img src="{{ absolute_url(asset('assets/logo_idee_22mars.jpg')) }}" alt="logo idee services" id="logo" class="float-left mr-2">
                    <h1 class="h3">FICHE DE<br>TRAVAIL</h1>
                    <a href="{{ url('schedules_show', { 'id': weeksheet.id }) }}" class="mt-3"><u>Voir en ligne</u></a>
                </div>
                <div class="col-3 lead">
                    {{ weeksheet.user.lastname | upper }} {{ weeksheet.user.firstname | capitalize }} <br>
                    {{ weeksheet.user.department.fullname }}
                </div>
                <div class="col-2 offset-4 text-center">
                    <p class="lead m-2">Semaine</p>
                    <p class="lead m-2">nÂ° <strong class="h3">{{ weeksheet.beginAt | format_date(pattern="w") }}</strong></p>
                    <p class="border border-dark p-2 h3 m-2">{{ weeksheet.beginAt | format_date(pattern="yyyy") }}</p>
                </div>                
            </div>
            <div class="row" id="header">
                <div class="col-1 text-danger pt-3">DATE</div>
                <div class="col-10"></div>
                <div class="col-1 text-center pt-3">HEURES</div>
            </div>
            {% for day in weeksheet.workDays %}
                <div class="row border">
                    <div class="col-1 pt-3 pb-3">
                        {{ day.datetime | format_date(pattern="eeee d MMM") }}
                    </div>
                    <div class="col-10">
                        <div class="d-flex mr-1 ml-1 position-relative">
                            {% for i in 5..20 %}
                                <div class="flex-fill bg-transparent grid">
                                    <small class="m-0 p-0">{{ i }}</small>
                                    <div class="border border-dark border-top-0 flex-fill d-flex">
                                        {% for index in 0..3 %}
                                            <small class="border border-top-0 flex-fill text-white">.</small>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endfor %}
                            {% for task in day.tasks %}
                                {% set beginAt = date(task.beginAt).diff(date("January 00, 1970 00:00")) %}
                                {% set begin = (beginAt.h + (beginAt.i / 60) - 5) / ( 21 - 5 ) * 100 %}
                                {% set interval = date(task.EndAt).diff(date(task.beginAt)) %}
                                {% set duration = (interval.h + (interval.i / 60)) / ( 21 - 5 ) * 100 %}
                                {% if loop.index is odd %}
                                    {% set fillColor = '#d2232c' %}
                                {% else %}
                                    {% set fillColor = '#17a2b8' %}
                                {% endif %}
                                <div class="position-absolute task-elmt" style="left:{{begin}}%;width:{{duration}}%;">
                                    <svg width="100%" height="12px">
                                        <rect width="100%" height="100%" x="0" y="0" fill="{{ fillColor }}" />
                                    </svg>
                                    {% set clientName = task.clientName|split(' - ') %}
                                    <p class="overflow-hidden mb-0 mr-2">{{ clientName[0] }}</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-1 text-center border-left d-flex align-items-center justify-content-center">{{ durations[day.id] }}</div>
                </div>
            {% endfor %}
            <div class="row">
                <div class="d-flex align-items-center justify-content-end col-11 p-2">
                    <p class="flex-fill font-italic">
                        Le {{ date() | format_datetime(pattern="eeee d MMMM y Ã  HH:mm") }}    
                    </p>
                    <p class="mb-0">Total =</p>
                </div>
                <div class="col-1 text-center border p-2"><strong>{{ durations['week'] }}</strong></div>
            </div>
        </div>
    </div>
</body>
